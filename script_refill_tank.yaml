# SPDX-License-Identifier: Apache-2.0
# Copyright (c) 2023 Ilia Sotnikov
---
if:
  condition:
    lambda: |-
      return ${condition};
  then:
    - logger.log:
        format: 'Triggering'
        tag: 'refill tank'
        level: 'INFO'
    - sprinkler.pause: ${sprinkler}
    - switch.turn_on: ${relay}
    - lambda: |-
        #ifdef HAS_DISPLAY
        ${display_id}->update();
        #endif
    - delay: ${refill_relay_pulse_duration}
    - switch.turn_off: ${relay}
    - sprinkler.resume: ${sprinkler}
    - lambda: |-
        #ifdef HAS_DISPLAY
        ${display_id}->update();
        #endif
    - logger.log:
        format: 'Triggered'
        tag: 'refill tank'
        level: 'INFO'
